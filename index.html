<!DOCTYPE html>
<html>
<head>
  <title>Jeu Manager Foot Multijoueur</title>
  <meta charset="UTF-8">
  <script type="module">
    // Import Firebase SDK
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
    import { getFirestore, collection, doc, setDoc, getDoc, onSnapshot } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

    // ⚠️ Remplace ceci par tes propres infos Firebase :
    const firebaseConfig = {
      apiKey: "TON_API_KEY",
      authDomain: "TON_PROJET.firebaseapp.com",
      projectId: "TON_PROJET",
      storageBucket: "TON_PROJET.appspot.com",
      messagingSenderId: "XXXXXXX",
      appId: "APP_ID"
    };

    // Initialiser Firebase
    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    // Demande le nom du joueur
    const player = prompt("Quel est ton pseudo ?");
    const club = prompt("Quel club veux-tu contrôler ?");

    // Référence à la ligue
    const leagueRef = doc(db, "ligue", "partie1");

    // Crée le joueur dans la base
    await setDoc(leagueRef, {
      [club]: {
        nom: player,
        transferts: []
      }
    }, { merge: true });

    // Fonction pour proposer un transfert
    async function proposerTransfert() {
      const cible = prompt("À quel club veux-tu proposer un transfert ?");
      const joueur = prompt("Quel joueur veux-tu acheter ?");
      const offre = prompt("Quel est ton prix ?");

      const snapshot = await getDoc(leagueRef);
      const data = snapshot.data();
      const ancien = data[cible]?.transferts || [];
      ancien.push({ de: club, joueur, prix: offre });

      await setDoc(leagueRef, {
        [cible]: {
          transferts: ancien
        }
      }, { merge: true });

      alert("Offre envoyée !");
    }

    // Surveille les offres reçues en temps réel
    onSnapshot(leagueRef, (docSnap) => {
      const data = docSnap.data();
      const mesOffres = data[club]?.transferts || [];

      if (mesOffres.length > 0) {
        const derniere = mesOffres[mesOffres.length - 1];
        alert(`Offre reçue de ${derniere.de} pour ${derniere.joueur} à ${derniere.prix}€`);
      }
    });

    window.proposerTransfert = proposerTransfert;
  </script>
</head>
<body>
  <h1>Jeu Manager Foot Multijoueur</h1>
  <button onclick="proposerTransfert()">Proposer un transfert</button>
</body>
</html>
